import{_ as S,a as f,m as T,b as O,c as i,e as t,C as _,D as a,f as n,t as l,h as P,z as k,w as x,r as m,o as r,K as C}from"./index-14e50f67.js";import{S as d}from"./sweetalert2.all-742031dd.js";import{c as v}from"./cartsStore-1cbb6115.js";const{VITE_APP_URL2:u,VITE_APP_PATH:g}={VITE_APP_URL:"https://card-pool-json-vercel.vercel.app",VITE_APP_URL2:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"lk1025cina",BASE_URL:"/cardPool-Vite-Airbnb/",MODE:"production",DEV:!1,PROD:!0},A={data(){return{ifFirstStep:!0,ifSecondStep:!1,ifThirdStep:!1,curOrderId:"-NQnw_-sBXJJrEsfC53i",curOrder:{},finalTotal:0,loadingStatus:{loadingItem:""}}},methods:{postNewOrder(o){o.data.courierTotal=this.courierTotal,console.log(o.data.courierTotal),this.perOrder=o;const s=`${u}/api/${g}/order`;f.post(s,o).then(c=>{console.log(c.data),this.curOrderId=c.data.orderId,this.ifFirstStep=!1,this.ifSecondStep=!0,d.fire({position:"center",icon:"success",title:"成功送出訂單",showConfirmButton:!1,timer:1800}),this.getPerOrder(),this.deleteAllCartToOrder()}).catch(c=>{console.log(c),d.fire({position:"center",icon:"error",title:`${c.message}`,showConfirmButton:!1,timer:1800})})},getPerOrder(){const o=`${u}/api/${g}/order/${this.curOrderId}`;f.get(o).then(s=>{console.log(s.data.order),this.curOrder=s.data.order,this.finalTotal=s.data.order.total}).catch(s=>{console.log(s),d.fire({position:"center",icon:"error",title:`${s.message}`,showConfirmButton:!1,timer:1800})})},confirmToPay(){this.loadingStatus.loadingItem=this.curOrderId,console.log(this.curOrderId);const o=`${u}/api/${g}/pay/${this.curOrderId}`;f.post(o).then(s=>{console.log(s.data),this.loadingStatus.loadingItem="",this.ifSecondStep=!1,this.ifThirdStep=!0,d.fire({position:"center",icon:"success",title:"付款成功",showConfirmButton:!1,timer:1800})}).catch(s=>{console.log(s),d.fire({position:"center",icon:"error",title:`${s.message}`,showConfirmButton:!1,timer:1800})})},...T(v,["deleteAllCartToOrder","getCart"])},mounted(){this.ifFirstStep=!0,this.ifThirdStep=!1,this.getCart(),this.ifSecondStep===!0&&this.getPerOrder()},computed:{courierTotal(){return this.carts.reduce((s,c)=>s+c.product.domestic_Transport.amount,0)},...O(v,["final_total","carts"])}},I={class:"container container-sm container-md container-lg mb-9 border-bottom border border-mainorange pb-9"},V={class:"row"},B={class:"col-lg-12"},F={class:"d-flex my-9 mx-6 justify-content-center checkout-step px-2 en-font"},D={class:"step px-md-4 px-1 fs-3 d-flex align-items-center"},E=t("p",{class:"num"},"1",-1),N=[E],j=t("p",{class:"fs-6 ms-md-4 ms-1 fs-sm-7"},"購物明細",-1),R={class:"step px-md-4 px-1 fs-3 d-flex align-items-center"},H=t("p",{class:"num"},"2",-1),L=[H],U=t("p",{class:"fs-6 ms-md-4 ms-1 fs-sm-6"},"付款方式",-1),M={class:"step px-md-4 px-1 fs-3 d-flex align-items-center"},z=t("p",{class:"num"},"3",-1),J=[z],K=t("p",{class:"fs-6 ms-md-4 ms-1 fs-sm-6"},"最終確認",-1),Q={key:0,class:"col-lg-12"},X=t("h4",{class:"fs-4 text-center"},"購物車尚無商品！",-1),q=[X],G={class:"row gx-6"},W={class:"col-lg-7"},Y={class:"col-lg-5"},Z={key:2,class:"col-lg-6"},$=t("h4",{class:"fs-4 text-center text-primary mb-3 fwt-heavy"},"訂單資料",-1),tt={class:"mb-8 fs-5 border border-primary border-2 py-4 px-8 bd-rd-12"},st={class:"fs-6 mb-2"},et=t("span",{class:"text-maingray fw-heavy"},"訂單成立時間：",-1),ot={class:"text-primary"},ct={class:"fs-6 mb-2"},rt=t("span",{class:"text-maingray fw-heavy"},"訂單編號：",-1),it={class:"text-primary"},at={class:"fs-6 mb-2"},nt=t("span",{class:"text-maingray fw-heavy"},"訂單總額：",-1),lt={class:"text-mainorange"},dt=t("li",null,[t("span",{class:"text-maingray fw-heavy"},"訂單狀態："),t("span",{class:"text-mainorange"},"待付款")],-1),ht={key:3,class:"col-lg-6"},_t=C('<h4 class="fs-4 text-center text-primary mb-3 fwt-heavy">運送資料</h4><ul class="mb-8 fs-5 bg-primary text-white py-4 px-8 bd-rd-12 d-flex flex-column justify-content-between"><li class="fs-6 mb-2"><span class="fw-heavy">聯絡信箱：</span></li><li class="fs-6 mb-2"><span class="fw-heavy">取貨人姓名：</span></li><li class="fs-6 mb-2"><span class="fw-heavy">取貨人手機：</span></li><li class="fs-6"><span class="fw-heavy">寄送地址：</span></li></ul>',2),pt=[_t],ft={key:4,class:"col-lg-12"},mt={class:"accordion accordion-flush bd-top-opa mb-9",id:"orderAccordionFlush"},ut={class:"accordion-item"},gt={class:"accordion-header",id:"orderAccordion"},bt={class:"accordion-button collapsed py-3 px-3 fs-5 text-primary",type:"button","data-bs-toggle":"collapse","data-bs-target":"#channelAccordionFlushCollapse","aria-expanded":"false","aria-controls":"channelAccordionFlushCollapse"},yt=t("span",{class:"dark-pink fs-6"},"購買明細",-1),xt=t("div",{id:"channelAccordionFlushCollapse",class:"accordion-collapse collapse","aria-labelledby":"channelAccordionFlushHeading","data-bs-parent":"#orderAccordionFlush"},[t("div",{class:"accordion-body"})],-1),vt={class:"d-flex justify-content-center"},wt=t("p",null,"付款",-1),St={key:5,class:"col-lg-12"},Tt=t("h1",{class:"fs-3 my-6 text-center"},"等待賣家確認訂單中，請至『我的後台』查詢訂單狀態",-1),Ot={class:"d-flex justify-content-center align-items-center"},Pt=t("p",null,"回首頁",-1),kt=t("p",null,"繼續逛逛",-1);function Ct(o,s,c,At,e,h){const b=m("router-view"),p=m("font-awesome-icon"),y=m("router-link");return r(),i("div",I,[t("div",V,[t("div",B,[t("ul",F,[t("li",D,[t("div",{class:_(["step-num",{navigate:e.ifFirstStep}])},N,2),j]),t("li",R,[t("div",{class:_(["step-num",{navigate:e.ifSecondStep}])},L,2),U]),t("li",M,[t("div",{class:_(["step-num",{navigate:e.ifThirdStep}])},J,2),K])])]),!o.carts.length&&e.ifThirdStep===!1?(r(),i("div",Q,q)):a("",!0),e.ifFirstStep?(r(),i("div",{key:1,class:_(["pink-box total-detail col-lg-12 border-top border-bottom border-6 border-secondary",{"border-0":!o.carts.length}])},[t("div",G,[t("div",W,[n(b,{name:"cart"})]),t("div",Y,[n(b,{name:"orderInfo",onPostNewOrder:h.postNewOrder},null,8,["onPostNewOrder"])])])],2)):a("",!0),e.ifSecondStep?(r(),i("div",Z,[$,t("ul",tt,[t("li",st,[et,t("span",ot,l(new Date(e.curOrder.create_at).getMonth()+1)+"月"+l(new Date(e.curOrder.create_at).getDate())+"日"+l(new Date(e.curOrder.create_at).getHours())+":"+l(new Date(e.curOrder.create_at).getMinutes()),1)]),t("li",ct,[rt,t("span",it,l(e.curOrderId),1)]),t("li",at,[nt,t("span",lt,l(e.finalTotal+h.courierTotal),1),P("元")]),dt])])):a("",!0),e.ifSecondStep?(r(),i("div",ht,pt)):a("",!0),e.ifSecondStep?(r(),i("div",ft,[t("div",mt,[t("div",ut,[t("h2",gt,[t("button",bt,[n(p,{icon:"fa-solid fa-tag",class:"me-3 dark-pink fs-6"}),yt])]),xt])]),t("div",vt,[t("button",{type:"button",class:"mx-auto btn btn-mainorange px-4 py-2 text-white fwt-heavy fs-5 bd-rd-12",onClick:s[0]||(s[0]=(...w)=>h.confirmToPay&&h.confirmToPay(...w))},[n(p,{icon:"fa-solid fa-dollar-sign me-2",class:"text-white fs-3 mb-1"}),wt,e.loadingStatus.loadingItem===e.curOrderId?(r(),k(p,{key:0,icon:"fa-solid fa-spinner"})):a("",!0)])])])):a("",!0),e.ifThirdStep?(r(),i("div",St,[Tt,t("div",Ot,[n(y,{to:"/",class:"me-4 btn btn-primary px-4 py-2 text-white fwt-heavy fs-6 bd-rd-12"},{default:x(()=>[Pt]),_:1}),n(y,{to:"/products",class:"btn btn-primary px-4 py-2 text-white fwt-heavy fs-6 bd-rd-12"},{default:x(()=>[kt]),_:1})])])):a("",!0)])])}const Ft=S(A,[["render",Ct]]);export{Ft as default};
