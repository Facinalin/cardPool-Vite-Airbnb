import{_ as w,a as C,m as E,b as T,c as u,e,t as l,F as P,y as U,D as x,C as b,z as M,h as m,f as _,K as D,o as d,r as B}from"./index-14e50f67.js";import{S as p}from"./sweetalert2.all-742031dd.js";import{c as L}from"./cartsStore-1cbb6115.js";const{VITE_APP_URL2:v,VITE_APP_PATH:k}={VITE_APP_URL:"https://card-pool-json-vercel.vercel.app",VITE_APP_URL2:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"lk1025cina",BASE_URL:"/cardPool-Vite-Airbnb/",MODE:"production",DEV:!1,PROD:!0},I={data(){return{product:{},domestic:{amount:0,courier:"",courier_Note:""},international:{amount:0,complement:""},finalLeftMember:{},domLeftMember:[{memberNo:"1",member:"Bangchan",imgUrl:"https://i.imgur.com/5PlS2aH.png",left:!1},{memberNo:"2",member:"Leeknow",imgUrl:"https://i.imgur.com/ATWXtR9.png",left:!1},{memberNo:"3",member:"Changbin",imgUrl:"https://i.imgur.com/XhAHWYu.png",left:!1},{memberNo:"4",member:"Hyunjin",imgUrl:"https://i.imgur.com/AANylPt.png",left:!1},{memberNo:"5",member:"Han",imgUrl:"https://i.imgur.com/UQ7he1p.png",left:!1},{memberNo:"6",member:"Felix",imgUrl:"https://i.imgur.com/UFTzeFH.png",left:!1},{memberNo:"7",member:"Seungmin",imgUrl:"https://i.imgur.com/UiFtZSu.png",left:!1},{memberNo:"8",member:"I.N",imgUrl:"https://i.imgur.com/3JdX3kx.png",left:!1}],memberQty:0,loadingStatus:{loadingItem:""},ifLogged:!1,mustWithScarce:!1}},methods:{getPerProduct(){const{id:a}=this.$route.params,r=`${v}/api/${k}/product/${a}`;this.$http.get(r).then(c=>{this.product=c.data.product,console.log(this.product),this.domestic.amount=c.data.product.domestic_Transport.amount,this.domestic.courier=c.data.product.domestic_Transport.courier,this.domestic.courier_Note=c.data.product.domestic_Transport.courier_Note,this.international.amount=c.data.product.international_Transport.amount,this.international.complement=c.data.product.international_Transport.complement;const i={...this.product.leftMember},t=Object.values(i),n=[];for(let s=0;s<t.length;s++)i[s]===null&&delete i[s],i[s]===!0&&n.push(`${s}`);this.finalLeftMember=i,this.product.mustChoose&&(this.mustWithScarce=!0,this.product.mustChoose.forEach(s=>{this.domLeftMember.forEach(o=>{o.memberNo===s&&(o.note="mustChoose")})})),this.product.scarcity&&this.product.scarcity.forEach(s=>{this.domLeftMember.forEach(o=>{o.memberNo===s&&(o.note="scarcity")})}),n.forEach(s=>{this.domLeftMember.forEach(o=>{o.memberNo===s&&(o.left=!0),o.memberNo===s&&!o.note&&(o.note="normal")})})}).catch(c=>{console.log(c)})},chooseMember(a,r){r.target.parentNode.classList.contains("memberDisabled")||(r.target.classList.toggle("activeSm"),r.target.classList.contains("activeSm")?this.memberQty+=1:this.memberQty-=1)},confirmJoin(a,r){const c=document.querySelectorAll(".perMemberOption img"),i=[];c.forEach(n=>{const s=n.getAttribute("data-id");n.classList.contains("activeSm")&&i.push(s)});const t=[...c].some(n=>n.classList.contains("activeSm"));if(console.log(t),!t)p.fire({position:"center",icon:"error",title:"請選擇至少一名成員！",showConfirmButton:!1,timer:1800});else{const n=document.querySelector(".red-area"),s=document.querySelector(".blue-area"),o=document.querySelectorAll(".red-area .per-member"),g=document.querySelectorAll(".blue-area .per-member");if(n&&s){let h=0,f=0;if(o.forEach(y=>{y.classList.contains("activeSm")&&h++}),g.forEach(y=>{y.classList.contains("activeSm")&&f++}),h!==f){p.fire({icon:"error",title:"無法卡位！",text:"紅區跟藍區須1:1帶！",allowOutsideClick:!0});return}}this.loadingStatus.loadingItem=a;let S={};if(this.cardGroupCart.find(h=>h.product_id===a)){this.loadingStatus.loadingItem="",document.querySelectorAll(".perMemberOption img").forEach(f=>{f.classList.remove("activeSm")}),this.memberQty=0,p.fire({position:"center",icon:"error",title:"本團已經有你的卡位紀錄，欲編輯成員請至後台修改！",showConfirmButton:!0});return}else S={product_id:a,qty:r,category:"拆卡",chooseMember:i,user:{name:"Mr.Demo",creatorSuccessHistory:3,participantSuccessHistory:5},created_at:new Date().getTime()};const A="post",N=`${v}/api/${k}/cart`;this.checkAdminToAdd(S,N,A)}},joinGroupLining(a,r,c){C[c](r,{data:a}).then(i=>{this.loadingStatus.loadingItem="",this.memberQty=0,p.fire({position:"center",icon:"success",title:"成功卡位，請至後台查詢排卡狀態!",showConfirmButton:!1,timer:1800}),document.querySelectorAll(".perMemberOption img").forEach(n=>{n.classList.remove("activeSm")}),this.getCardGroupCart()}).catch(i=>{this.loadingStatus.loadingItem="",p.fire({position:"center",icon:"error",title:`${i.message}`,showConfirmButton:!1,timer:1800})})},checkAdminToAdd(a,r,c){const i=`${v}/api/user/check`;C.post(i).then(t=>{this.ifLogged=!0,this.joinGroupLining(a,r,c)}).catch(t=>{p.fire({position:"center",icon:"error",title:t.response.data.message,showConfirmButton:!1,timer:1800}),this.$router.push("/logIn")})},...E(L,["getCardGroupCart"])},computed:{...T(L,["cardGroupCart"])},mounted(){this.getCardGroupCart(),this.getPerProduct()}},O={class:"container my-5"},V={class:"row"},j={class:"product-img col-md-12 col-lg-5 col-12 mt-9"},Q={class:"d-flex justify-content-center mb-6"},q=["src"],F={class:"col-md-12 col-lg-7 ps-lg-9 ch-font mt-9"},G={class:"mb-3 fs-1 lh1-5"},H={class:"mb-1 fs-7"},R={class:"mb-2 dark-pink fs-7"},W={class:"member-option"},J={class:"member-row member-row-sm d-flex justify-content-between flex-wrap mb-2"},z=["onClick"],X=["src","alt","data-id"],Y={class:"text-primary fs-3"},K={class:"px-lg-2 d-flex flex-column align-items-end mt-50"},Z=e("p",{class:"fs-7 mb-1"},"＊請仔細檢查卡位成員後再送出，送出後更改成員若影響到排卡順序自行負擔。",-1),$={key:0,class:"fs-7 mb-1"},ee={class:"btn-area btns d-flex justify-content-end"},te={class:"memberQty"},oe={type:"button",class:"product-btn btn btn-white border-primary rounded-xxl py-1 px-3 bd-rd-12"},se=e("div",{class:"col-12"},[e("div",{class:"notice border border-2 border-secondary d-flex flex-wrap mt-5 mb-80"},[e("p",{class:"col-sm-12 col-md-6 col-lg-6 py-4 px-5"},[m(" Q：我要如何知道成團與否？"),e("br"),m(" （1) 請至註冊信箱內檢查email。"),e("br"),m(" （2) 請至『會員專區>收藏與排卡>卡位狀態查詢』查看成團進度。 ")]),e("p",{class:"col-sm-12 col-md-6 col-lg-6 py-4 px-5"},[m(" Q：我要如何取消卡位？"),e("br"),m(" * 本站取消規定：當初卡的成員位數全部取消。請私訊賣家告知取消理由，賣方可從後台手動取消。 ")])])],-1),ce={class:"col-12 ch-font"},re={class:"product-details"},ie={class:"details-1 bd-top-opa col-12 d-flex flex-wrap mt-5 text-maingray"},ne={class:"seller col-12 py-3 px-3 d-flex align-items-center justify-content-between"},ae=D('<div class="seller-left d-flex align-items-center"><img class="seller-pic" src="https://i.imgur.com/YxLmY3t.png" alt="sellerpic"><h5 class="ms-2">Tracy</h5><p class="ms-6">主拆成團 <span class="text-primary">4</span> 筆</p></div>',1),le={class:"seller-right"},me={type:"button",class:"seller-btn btn btn-white border-secondary rounded-xxl py-1 px-2 me-2"},de=e("a",{href:"#",class:"seller-btn btn btn-white border-secondary rounded-xxl py-1 px-2"},"查看賣場",-1),ue={class:"internationalFee col-12 py-3 px-3 bd-top-opa d-flex justify-content-between"},pe={key:0,class:"text-mainorange pe-1"},he={key:1,class:"text-orange pe-1"},fe={key:2,class:"text-mainorange pe-1"},be={class:"accordion accordion-flush bd-top-opa",id:"accordionFlushExample"},_e={class:"accordion-item"},ge={class:"accordion-header",id:"flush-headingOne"},ye={class:"accordion-button collapsed py-3 px-3",type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseOne","aria-expanded":"false","aria-controls":"flush-collapseOne"},xe={id:"flush-collapseOne",class:"accordion-collapse collapse","aria-labelledby":"flush-headingOne","data-bs-parent":"#accordionFlushExample"},ve={class:"accordion-body"},Se={class:"domesticCourier"},Ce={class:"product-description col-12 bd-top-opa py-2 px-3 mb-8"},Le={class:"description"},ke=e("ul",{class:"pic-area"},null,-1);function Ae(a,r,c,i,t,n){const s=B("font-awesome-icon");return d(),u("div",O,[e("div",V,[e("div",j,[e("div",Q,[e("img",{src:t.product.imgUrl,alt:"",class:"cardImg"},null,8,q)])]),e("div",F,[e("h1",G,l(t.product.title),1),e("p",H,"卡團編號：#"+l(t.product.id),1),e("p",R,l(t.product.channel),1),e("div",W,[e("div",J,[(d(!0),u(P,null,U(t.domLeftMember,o=>(d(),u("div",{key:o.member,class:b(["perMemberOption d-flex flex-column justify-content-center align-items-center mb-2",{"red-area":o.note==="mustChoose","blue-area":o.note==="scarcity","white-area":o.note==="normal"}]),onClick:g=>n.chooseMember(o,g)},[e("div",{class:b(["member-img-sm mb-1",{memberDisabled:!o.left}])},[e("img",{class:"per-member small-head",src:o.imgUrl,alt:o.member,"data-id":o.memberNo},null,8,X)],2),e("h2",{class:b(["text-maingray text-center fs-7 mb-1",{txtDisabled:!o.left}])},l(o.member),3)],10,z))),128))])]),e("h2",Y,"$"+l(t.product.price)+"元",1),e("div",K,[Z,t.mustWithScarce===!0&&t.product.mustChoose.length===t.product.scarcity.length?(d(),u("p",$,"＊帶藍區必帶紅區（1:1帶），請確認是否達成必填門檻，否則將無法送出。")):x("",!0)])]),e("div",ee,[e("button",{type:"button",class:b(["product-btn btn btn-white border-primary rounded-xxl py-1 px-3 me-3 confirmJoinBtn d-flex bd-rd-12",{disabled:t.loadingStatus.loadingItem===t.product.id}]),onClick:r[0]||(r[0]=o=>n.confirmJoin(t.product.id,t.memberQty))},[t.loadingStatus.loadingItem===t.product.id?(d(),M(s,{key:0,icon:"fa-solid fa-spinner",class:"me-1"})):x("",!0),m(" 確認卡位"),e("span",te,l(t.memberQty),1)],2),e("button",oe,[m("收藏"),_(s,{icon:"fa-solid fa-heart",class:"ms-1"})])]),se,e("div",ce,[e("div",re,[e("div",ie,[e("div",ne,[ae,e("div",le,[e("button",me,[_(s,{icon:"fa-solid fa-comment",class:"me-3 text-secondary fs-5"}),m(" 訊息")]),de])]),e("div",ue,[e("p",null,[_(s,{icon:"fa-solid fa-plane",class:"me-3 text-primary fs-5"}),m(" 國際運費 ")]),t.international.complement===!0?(d(),u("p",pe,"需二補")):(d(),u("p",he,"無需二補")),t.international.amount!==0?(d(),u("p",fe,l(t.international.amount)+"元",1)):x("",!0)]),e("div",be,[e("div",_e,[e("h2",ge,[e("button",ye,[_(s,{icon:"fa-solid fa-truck",class:"me-3 text-primary fs-5"}),m(" 國內運費 ")])]),e("div",xe,[e("div",ve,[e("ul",Se,[e("li",null,l(t.domestic.courier)+l(t.domestic.amount)+"元"+l(t.domestic.courier_Note),1)])])])])]),e("div",Ce,[e("p",Le,l(t.product.description),1)]),ke])])])])])}const Pe=w(I,[["render",Ae]]);export{Pe as default};
