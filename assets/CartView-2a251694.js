import{p as g}from"./productsStore-1e1c1ee8.js";import{c as f}from"./cartsStore-1cbb6115.js";import{S as c}from"./sweetalert2.all-742031dd.js";import{_ as y,m as b,a as k,b as C,c as r,e as t,F as x,y as T,t as a,o as i,z as I,D as w,h as S,f as $,r as v}from"./index-14e50f67.js";const{VITE_APP_URL2:u,VITE_APP_PATH:_}={VITE_APP_URL:"https://card-pool-json-vercel.vercel.app",VITE_APP_URL2:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"lk1025cina",BASE_URL:"/cardPool-Vite-Airbnb/",MODE:"production",DEV:!1,PROD:!0},P=localStorage.getItem("user1hrToken"),A=Number(localStorage.getItem("userId")),V={data(){return{cartTotal:0,perCart:{},thisUserCart:[],ifLoggedIn:!0,loadingStatus:{loadingItem:""}}},methods:{deletePerCart(e){this.loadingStatus.loadingItem=e;const o=`${u}/api/${_}/cart/${e}`;this.$http.delete(o).then(l=>{console.log(l.data),console.log(o),c.fire({position:"center",icon:"success",title:"成功刪除一筆購物車!",showConfirmButton:!1,timer:1800}),this.loadingStatus.loadingItem="",this.getCart()}).catch(l=>{console.log(l)})},deleteAllCart(){const e=`${u}/api/${_}/carts`;this.$http.delete(e).then(o=>{c.fire({position:"center",icon:"success",title:"購物車已清空！",showConfirmButton:!1,timer:1800}),this.loadingStatus.loadingItem="",this.getCart()}).catch(o=>{c.fire({position:"center",icon:"error",title:`${o.message}`,showConfirmButton:!1,timer:1800})}),this.getCart()},setCartQty(e,o){this.loadingStatus.loadingItem=e.id;const l=`${u}/api/${_}/cart/${e.id}`,h=o.target.value*1,d={product_id:e.product_id,qty:h};this.$http.put(l,{data:d}).then(n=>{console.log(n.data),this.loadingStatus.loadingItem="",this.getCart()}).catch(n=>{c.fire({position:"center",icon:"error",title:`${n.message}`,showConfirmButton:!1,timer:1800})})},phoneVali(e){return/^(09)[0-9]{8}$/.test(e)?!0:"請填入正確的電話號碼！"},checkLoggedIn(){P&&A&&(this.ifLoggedIn=!0)},...b(g,["getProductS"]),...b(f,["getCart"])},mounted(){const e=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");k.defaults.headers.common.Authorization=e,this.getCart()},computed:{courierTotal(){return this.carts.reduce((o,l)=>o+l.product.domestic_Transport.amount,0)},...C(g,["products"]),...C(f,["carts","final_total"])}},z={key:0,class:"border-0 d-flex justify-content-center"},N={key:1,class:"shopping-cart"},B={class:"cart-table mt-4 text-center"},E=t("thead",null,[t("tr",{class:"text-primary fs-5 pb-4"},[t("th",{width:"40%",class:"py-3 bd-l-12"},"品項"),t("th",{width:"15%"},"單價"),t("th",{width:"10%"},"數量"),t("th",{width:"15%"},"小計"),t("th",{width:"10%"},"運費"),t("th",{width:"10%"},"刪除")])],-1),L={class:"cardItem-title d-flex align-items-center py-4"},U=["src","alt"],D={class:"text-center align-middle pt-0 pb-3 ps-4 pe-4 fz-20 ms-2"},R={class:"fz-20 text-center align-middle"},q={class:"text-center align-middle pt-4"},Q={class:"input-group input-group-sm"},j={class:"input-group mb-3"},F=["value","onChange"],H={class:"text-center align-middle mt-2"},O={class:"checkoutSubtotal fz-20"},M={class:"text-center align-middle mt-2"},G={class:"text-center align-middle"},J=["onClick"],K={scope:"row",class:"border-top border-secondary border-1"},W=t("td",null,null,-1),X=t("td",null,null,-1),Y=t("td",null,null,-1),Z=t("td",{class:"mt-4 text-end"},[t("p",{class:"fz-20 mt-3 me-2"},"小計")],-1),tt={class:"fz-20 dark-pink"},et={scope:"row"},st=t("td",null,null,-1),ot=t("td",null,null,-1),nt=t("td",null,null,-1),lt=t("td",{class:"mt-4 text-end"},[t("p",{class:"fz-20 mt-3 me-2"},"運費")],-1),at={class:"fz-20 dark-pink"},it={scope:"row"},ct=t("td",null,null,-1),rt=t("td",null,null,-1),dt=t("td",null,null,-1),ut=t("td",{class:"mt-4 text-end"},[t("p",{class:"fz-20 mt-3 me-2"},"總金額")],-1),_t={class:"fz-20 text-mainorange cartTotal"},ht={class:"deleteAllCart text-center my-5"};function mt(e,o,l,h,d,n){const m=v("font-awesome-icon");return e.carts.length?(i(),r("div",N,[t("table",B,[E,t("tbody",null,[(i(!0),r(x,null,T(e.carts,s=>(i(),r("tr",{key:s.id,class:"perItemCheckout py-4"},[t("td",null,[t("div",L,[t("img",{src:s.product.imgUrl,alt:s.product.title,class:"per-cart-pic"},null,8,U),t("p",D,a(s.product.title),1)])]),t("td",R,a(s.product.price),1),t("td",q,[t("div",Q,[t("div",j,[t("input",{min:"1",type:"number",class:"form-control",value:s.qty,onChange:p=>n.setCartQty(s,p)},null,40,F)])])]),t("td",H,[t("span",O,a(s.product.price*s.qty),1)]),t("td",M,a(s.product.domestic_Transport.amount),1),t("td",G,[t("button",{type:"button",class:"btn btn-sm text-mainorange",onClick:p=>n.deletePerCart(s.id)},[d.loadingStatus.loadingItem===s.id?(i(),I(m,{key:0,icon:"fa-solid fa-spinner",class:"me-1 fs-4"})):w("",!0),S(),$(m,{icon:"fa-solid fa-trash",class:"fs-5"})],8,J)])]))),128))]),t("tfoot",null,[t("tr",K,[W,X,Y,Z,t("td",tt,"NT$"+a(e.final_total),1)]),t("tr",et,[st,ot,nt,lt,t("td",at,"NT$"+a(n.courierTotal),1)]),t("tr",it,[ct,rt,dt,ut,t("td",_t,"NT$"+a(e.final_total+n.courierTotal),1)])])]),t("div",ht,[t("button",{class:"btn btn-mainorange text-white bd-rd-12",type:"button",onClick:o[0]||(o[0]=(...s)=>n.deleteAllCart&&n.deleteAllCart(...s))},"清空購物車")])])):(i(),r("div",z))}const Ct=y(V,[["render",mt]]);export{Ct as default};
